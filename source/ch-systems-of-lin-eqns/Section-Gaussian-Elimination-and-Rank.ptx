<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="Section-Gaussian-Elimination-and-Rank" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Gaussian Elimination and Rank</title>

<subsection xml:id="Subsection-Row-Echelon-and-Reduced-Row-Echelon-Forms">
    <title>Row Echelon and Reduced Row Echelon Forms</title>

<p>
In <xref ref="Section-Augmented-Matrix-Notation-and-Elementary-Row-Operations"/>, we learned to write linear systems in <term>augmented matrix</term> form and use elementary row operations to transform an augmented matrix to <term>row-echelon form</term> and the <term>reduced row-echelon form</term> in order to solve linear systems.  
</p>

<p>
Recall that a matrix (or augmented matrix) is in <term>row-echelon form</term> if:
<ul>
<li>
      <p> All entries <em>below</em> each leading entry are <m>0</m>. </p>
</li>
<li>
      <p> Each leading entry is in a column to the right of the leading entries in the rows above it. </p>
</li>
<li>
      <p> All rows of zeros, if there are any, are located below non-zero rows. </p>
</li>
</ul>

A matrix in row-echelon form is said to be in <term>reduced row-echelon form</term> if it has the following additional properties
<ul>
<li>
      <p> Each leading entry is a <m>1</m> </p>
</li>
<li>
      <p> All entries <em>above</em> each leading <m>1</m> are <m>0</m> </p>
</li>
</ul>


Matrices in row-echelon form and reduced row-echelon form are ``convenient" because their corresponding systems of equations are easy to solve.  
</p>

<p>
In this module we turn to the question of existence and uniqueness of the two echelon forms.  Can every matrix (augmented matrix) be carried to a row-echelon form?  If so, is the row-echelon form unique?  Can every matrix be reduced to a reduced row-echelon form?  If so, is the reduced row-echelon form unique?  The answers we find will have long-lasting implications.
</p>

<exploration xml:id="init-gaussianelim1">
    <p>
        Solve the following system of equations.

<me>
    \begin{array}{ccccccccc}
      x \amp + \amp 2y\amp -\amp 3z\amp = \amp 1 \\
	 -5x\amp  +\amp 2y\amp -\amp 3z\amp =\amp 1\\
      x\amp - \amp 2y\amp +\amp z\amp =\amp 1
    \end{array}
</me>


We create an augmented matrix corresponding to the system and apply row operations until the matrix is in row-echelon form.  

<me>
    \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp -2\amp 1\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 12\amp -18\amp 6\\0\amp -4\amp 4\amp 0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{3}R_2}\\
 \end{array}
</me>

 <men xml:id="eq-ref1">
 \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 12\amp -18\amp 6\\0\amp 0\amp -2\amp 2
 \end{array}\right]
</men>

Note that the elementary row operations that lead to <xref ref="eq-ref1"/> were not prescribed.  We may employ row-operations in a different manner and obtain a different matrix in row-echelon form.  For example, suppose for some reason we had begun by switching the first and third rows.


<me>
    \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp -2\amp 1\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_1\leftrightarrow R_3}\\
\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp 2\amp -3\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
\\
\\
 \end{array}
</me>


Next we would reduce this matrix to row-echelon form, perhaps in this way:


<me>
    \left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp 2\amp -3\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\0\amp -8\amp 2\amp 6\\0\amp 4\amp -4\amp 0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{2}R_2}\\
 \end{array}

</me>

<men xml:id="eq-ref2">
 \left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\0\amp -8\amp 2\amp 6\\0\amp 0\amp -3\amp 3
 \end{array}\right]
</men>

The augmented matrices in <xref ref="eq-ref1"/> and <xref ref="eq-ref2"/> are clearly not the same, but both are in row-echelon form.

If we write the systems of equations corresponding to <xref ref="eq-ref1"/> and <xref ref="eq-ref2"/>, we can employ back substitution to solve them.  The matrix in <xref ref="eq-ref1"/> corresponds to

<me>
    \begin{array}{ccccccccc}
      x \amp + \amp 2y\amp -\amp 3z\amp = \amp 1 \\
	 \amp  \amp 12y\amp -\amp 18z\amp =\amp 6\\
      \amp \amp \amp \amp -2z\amp =\amp 2
    \end{array}
</me>

    
The matrix in <xref ref="eq-ref2"/> corresponds to    

<me>
    \begin{array}{ccccccccc}
      x \amp - \amp 2y\amp +\amp z\amp = \amp 1 \\
	 \amp  \amp -8y\amp +\amp 2z\amp =\amp 6\\
      \amp \amp \amp \amp -3z\amp =\amp 3
    \end{array}
</me>

    
Because both systems are equivalent to the original system, it is not surprising that back substitution yields the same solution for both systems. 


<me>
    x=0,\quad y=-1,\quad z=-1
</me>


<!-- 
%From the last equation we get <m>z=-1</m>.  
%Next, from the second equation we have <m>12y-18(-1)=6</m>, which yields <m>y=-1</m>.
%Finally, the first equation gives us <m>x+2(-1)-3(-1)=1</m>.  Solving for <m>x</m> we get <m>x=0</m>.  
%Therefore, the solution to the system is 
-->
<me>
    x=0, y=-1, z=-1
</me>
<!-- 
%We arrive at a different matrix in row-echelon form, but back-substitution yields the same solution to the system (you should check this):  
-->
<me>
    x=0, y=-1, z=-1
</me>
    </p>
</exploration>

<p>
It is clear from <xref ref="init-gaussianelim1"/> that a row-echelon form corresponding to a matrix is not unique.  But what about the reduced row-echelon form?
</p>

<exploration xml:id="init-gaussianelim2">
    <p>
        In this problem we revisit the system

<me>
    \begin{array}{ccccccccc}
      x \amp + \amp 2y\amp -\amp 3z\amp = \amp 1 \\
	 -5x\amp  +\amp 2y\amp -\amp 3z\amp =\amp 1\\
      x\amp - \amp 2y\amp +\amp z\amp =\amp 1
    \end{array}
</me>

    
Following the steps we took to get <xref ref="eq-ref1"/>, but taking the process a little further, we get the reduced row-echelon form.

<me>
    \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp -2\amp 1\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 12\amp -18\amp 6\\0\amp -4\amp 4\amp 0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{3}R_2}\\
 \end{array}
</me>

 
<me>
    \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 12\amp -18\amp 6\\0\amp 0\amp -2\amp 2
 \end{array}\right]
  \color{blue}
 \begin{array}{c}
 \\
  \xrightarrow{\frac{1}{12}R_2}\\
 \xrightarrow{-\frac{1}{2}R_3}\\
 \end{array}
 \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 1\amp -\frac{3}{2}\amp \frac{1}{2}\\0\amp 0\amp 1\amp -1
 \end{array}\right]
  \begin{array}{c}
  \xrightarrow{R_1+3R_3}\\
 \xrightarrow{R_2+\frac{3}{2}R_3}\\
\\
 \end{array}
</me>

<men xml:id="eq-rref3">  \color{blue}
 \left[\begin{array}{ccc|c}  
 1\amp 2\amp 0\amp -2\\0\amp 1\amp 0\amp -1\\0\amp 0\amp 1\amp -1
 \end{array}\right]
  \begin{array}{c}
  \xrightarrow{R_1-2R_2}\\
 \\
\\
 \end{array}
 \color{black}
  \left[\begin{array}{ccc|c}  
 1\amp 0\amp 0\amp 0\\0\amp 1\amp 0\amp -1\\0\amp 0\amp 1\amp -1
 \end{array}\right]</men>
Do you think it is possible to start with <xref ref="eq-ref2"/> and obtain the same reduced row-echelon form?  Try to justify your response.  If possible, find the elementary row operations that take <xref ref="eq-ref2"/> to the reduced row-echelon form in <xref ref="eq-rref3"/>.


<me>
    \left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp -2\amp 1\amp 1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_1\leftrightarrow R_3}\\
\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp 2\amp -3\amp 1
 \end{array}\right]
</me>


<me>
    \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\0\amp -8\amp 2\amp 6\\0\amp 4\amp -4\amp 0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{2}R_2}\\
 \end{array}

</me>

<me>
  \left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\0\amp -8\amp 2\amp 6\\0\amp 0\amp -3\amp 3
 \end{array}\right]
 \color{red}
 \begin{array}{c}
\rightsquigarrow\text{Elementary}\rightsquigarrow\\
\text{Row Ops.}
\end{array}
 \color{black}
  \left[\begin{array}{ccc|c}  
 1\amp 0\amp 0\amp 0\\0\amp 1\amp 0\amp -1\\0\amp 0\amp 1\amp -1
 \end{array}\right]
</me>
You will be asked to fill in the elementary row operations in <xref ref="prob-same-rref"/>.
    </p>
</exploration>

<p>
Our observations in <xref ref="init-gaussianelim2"/> are summarized in the following diagram.
</p>

<image width="100%">
   <shortdescription></shortdescription>
    <latex-image>
      \begin{tikzpicture}
  \node[] at (0, 0)  (o)    {\(\left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\-5\amp 2\amp -3\amp 1\\1\amp -2\amp 1\amp 1
 \end{array}\right]\)};
 \node[] at (-3, -2.5)  (left1)    {\(\left[\begin{array}{ccc|c}  
 1\amp 2\amp -3\amp 1\\0\amp 12\amp -18\amp 6\\0\amp 0\amp -2\amp 2
 \end{array}\right]\)};
 \node[] at (3, -2.5)  (right1)    {\(\left[\begin{array}{ccc|c}  
 1\amp -2\amp 1\amp 1\\0\amp -8\amp 2\amp 6\\0\amp 0\amp -3\amp 3
 \end{array}\right]\)};
 \node[gray] at (0, -2.5)  (c1)    {\shortstack{Row-\\Echelon\\Forms}};
 \node[] at (0, -5)  (c2)    {\(\left[\begin{array}{ccc|c}  1\amp 0\amp 0\amp 0\\0\amp 1\amp 0\amp -1\\0\amp 0\amp 1\amp -1
 \end{array}\right]\)};
 \node[gray] at (0, -6)  (c3)    {Reduced Row-Echelon Form};
 
 \draw [-\gt ,line width=0.5pt,-stealth]  (o.west)to[out=180, in=90](left1.north);
  \draw [-\gt ,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north west);
  \draw [-\gt ,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north east);
  \draw [-\gt ,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north);
 \draw [-\gt ,line width=0.5pt,-stealth]  (o.east)to[out=0, in=90](right1.north);
 \draw [-\gt ,line width=0.5pt,-stealth,blue]  (left1.south)to[out=270, in=180](c2.west);
 \draw [-\gt ,line width=0.5pt,-stealth,red]  (right1.south)to[out=270, in=0](c2.east);
     \end{tikzpicture}
    </latex-image>
</image>

<p>
We observed that a row-echelon form associated with a matrix is not unique.  In contrast, we also saw how different sequences of elementary row operations lead to the same solution set and the same reduced row-echelon form.  It turns out that the reduced row-echelon form of a matrix is unique.  
</p>

<theorem xml:id="th-uniquenessofrref">
    <statement>
        <p>
            The reduced row-echelon form of a matrix is unique.
        </p>
    </statement>
</theorem>
<p>
A proof of this result can be found in <xref ref="ref-Yuster"/>. 
</p>

<p>
The reduced row-echelon form of a matrix is an instance of a row-echelon form of the matrix.  While a given matrix may have multiple row-echelon forms, all row-echelon forms will share one characteristic: the number of nonzero rows in a row-echelon form of the given matrix will be the same.
We will prove this result in <xref ref="th-samenumberofnonzerorows"/>.
</p>
</subsection>

<subsection xml:id="Subsection-Gaussian-and-Gauss-Jordan-Elimination">
    <title>Gaussian and Gauss-Jordan Elimination</title>

<definition xml:id="def-GaussianElimination">
    <title>Gaussian Elimination</title>
    <statement>
        <p>
            The process of using the elementary row operations on a matrix to transform it into row-echelon form is called <term>Gaussian Elimination</term>.
        </p>
    </statement>
</definition>

<p>
    As we saw in the previous section, it is possible to follow different sequences of row operations to arrive at various row-echelon forms.  However, it was not clear whether it is <em>always possible</em> to find a row-echelon form.  The following algorithm takes any matrix (or augmented matrix) and transforms it into row-echelon form:
</p>

<algorithm xml:id="alg-gaussian">
    <title>Gaussian Algorithm</title>
    <statement>
        <p>
            Let <m>A</m> be an <m>m\times n</m> matrix.

Set <m>i=1</m> initially.
<ul>
<li>
      <p> Step 1. If <m>A</m> consists entirely of zeros, stop;  <m>A</m> is already in row-echelon form. </p>
</li>

<li>
      <p> Step 2. Otherwise, find the first column from the left containing a nonzero entry in row <m>i</m> or below row <m>i</m>.  This column will be called a <term>pivot column</term>.  Go down the pivot column, beginning with row <m>i</m>. Pick the topmost nonzero entry and call it <m>a</m>. If <m>a</m> is not in row <m>i</m>, switch rows so that <m>a</m> moves to row <m>i</m>.  Now <m>a</m> is the <term>leading entry</term> in its row.  We will also refer to <m>a</m> as a <term>pivot</term>.   </p>
</li>

<li>
      <p> Step 3. By subtracting multiples of the row containing <m>a</m> from rows below it, make each entry below <m>a</m> zero. </p>
</li>

<li>
      <p> Step 4.  Set <m>i=i+1</m>.  If <m>i\gt m</m> then stop; <m>A</m> is in row-echelon form. </p>
</li>

</ul>

Repeat steps 1--4 on the matrix consisting of the remaining rows.
When the process stops, <m>A</m> will be in row echelon form.
        </p>
    </statement>
</algorithm>

<p>
Gaussian Algorithm guarantees that every matrix will have a row-echelon form.  
</p>

<example xml:id="ex-non-augmented">
    <statement>
        <p>
            Use the Gaussian Algorithm to find a row-echelon form of <m>A</m> if 
<me>
    A=\begin{bmatrix}2\amp 4\\1\amp 2\\-1\amp 1\\3\amp 5\end{bmatrix}
</me>
       </p>
    </statement>
    <answer>
        <p>
            Following Step 2, we choose the first entry, <m>2</m>, as our pivot.  We then perform step 3, using the top row to get zeros in all entries below the <m>2</m>.

<me>
    \begin{bmatrix} \fbox{\(2\)}\amp 4\\1\amp 2\\-1\amp 1\\3\amp 5\end{bmatrix}
  \begin{array}{c}
  \\
  \xrightarrow{R_2-(1/2)R_1}\\
  \xrightarrow{R_3+(1/2)R_1}\\
 \xrightarrow{R_4-(3/2)R_1}\\
 \end{array}
\begin{bmatrix}2\amp 4\\0\amp 0\\0\amp 3\\0\amp -1\end{bmatrix}

</me>

The first row is now complete, and we repeat the process on the rows below it. We identify <m>3</m> as a pivot entry in the second column and move the row containing <m>3</m> to be directly below the first completed row.  We then use the <m>3</m> to make each entry below the <m>3</m> a zero.  


<me>
    \begin{bmatrix}2\amp 4\\0\amp 0\\0\amp \fbox{\(3\)}\\0\amp -1\end{bmatrix}
\xrightarrow{R_2\leftrightarrow R_3}\\
\begin{bmatrix}2\amp 4\\0\amp \fbox{\(3\)}\\0\amp 0\\0\amp -1\end{bmatrix}
  \begin{array}{c}
 \\
\\
  \\
 \xrightarrow{R_4+\frac{1}{3}R_2}\\
 \end{array}
 \begin{bmatrix}2\amp 4\\0\amp 3\\0\amp 0\\0\amp 0\end{bmatrix}

</me>

This time the algorithm terminates since row 3 and row 4 are zero rows.
       </p>
    </answer>
</example>
 


<definition xml:id="def-GaussJordanElimination">
    <title>Gauss-Jordan Elimination</title>
    <statement>
        <p>
            The process of using the elementary row operations on a matrix to transform it into reduced row-echelon form is called <term>Gauss-Jordan elimination</term>.
        </p>
    </statement>
</definition>

<p>
Given a matrix in row-echelon form, it is easy to bring it the reduced row-echelon form.  For example, continuing with <xref ref="ex-non-augmented"/>, we can start where we left off and compute <m>\mbox{rref}(A)</m>.  From our earlier computations we have:


<me>
    \begin{bmatrix}2\amp 4\\-1\amp 1\\3\amp 5\\1\amp 2\end{bmatrix}\rightsquigarrow\begin{bmatrix}2\amp 4\\0\amp 3\\0\amp 0\\0\amp 0\end{bmatrix}
</me>


Now we create leading <m>1's</m> and use them to to wipe out all non-zero entries above them.

<me>
    \begin{bmatrix}2\amp 4\\0\amp 3\\0\amp 0\\0\amp 0\end{bmatrix}
  \begin{array}{c}
    \xrightarrow{(1/2)R_1}\\
  \xrightarrow{(1/3)R_2}\\
  \\ 
  \\
 \end{array}
\begin{bmatrix}1\amp 2\\0\amp 1\\0\amp 0\\0\amp 0\end{bmatrix}
  \begin{array}{c}
  \xrightarrow{R_1-2R_2}\\
\\
\\
 \\
 \end{array}
\begin{bmatrix}1\amp 0\\0\amp 1\\0\amp 0\\0\amp 0\end{bmatrix}=\mbox{rref}(A)
</me>


The following modification to the Gaussian Algorithm produces the reduced row-echelon form of a matrix.  This algorithm guarantees the existence of the reduced row-echelon form.
</p>

<algorithm xml:id="alg-gauss-jordan">
    <title>Gauss-Jordan Algorithm</title>
    <statement>
        <p>
            Let <m>A</m> be an <m>m\times n</m> matrix.
            Follow the steps of the Gaussian Algorithm but modify Step 2 to create leading <m>1's</m> by multiplying the row containing <m>a</m> by <m>\frac{1}{a}</m>.
            When the Gaussian Algorithm terminates, subtract multiples of the rows containing leading <m>1's</m> from the rows above to make all entries above the pivots zero.
        </p>
    </statement>
</algorithm>





<p> 
The algorithm is an essential tool in linear algebra. An fully detailed example is provided below.
</p> 




<example xml:id="ex-gaussjordanalg">
    <statement>
        <p>
            Use the Gauss-Jordan Algorithm to solve the system

<me>
    \begin{array}{ccccccccc}
      3x \amp + \amp y\amp +\amp 7z\amp = \amp 7 \\
	 5x\amp  +\amp 3y\amp +\amp 9z\amp =\amp 13\\
      2x\amp + \amp y\amp +\amp 4z\amp =\amp 5
    \end{array}
</me>
       </p>
    </statement>
    <answer>
        <p>
            <md>
                <mrow> 
                    \amp \left[\begin{array}{ccc|c}  
                    \fbox{\(3\)}\amp 1\amp 7\amp 7\\5\amp 3\amp 9\amp 13\\2\amp 1\amp 4\amp 5
                    \end{array}\right] 
                </mrow>
                <mrow> 
                    \begin{array}{c}
                    \xrightarrow{\frac{1}{3}R_1}\\
                  \\
                  \\
                   \end{array}
                   \amp \left[\begin{array}{ccc|c}  
                   \fbox{\(1\)}\amp 1/3\amp 7/3\amp 7/3\\5\amp 3\amp 9\amp 13\\2\amp 1\amp 4\amp 5
                   \end{array}\right] 
                </mrow>
                <mrow> 
                    \begin{array}{c}
                    \\
                    \xrightarrow{R_2-5R_1}\\
                   \\
                   \end{array}
                   \amp \left[\begin{array}{ccc|c}  
                    \fbox{\(1\)}\amp 1/3\amp 7/3\amp 7/3\\0\amp 4/3\amp -8/3\amp 4/3\\2\amp 1\amp 4\amp 5
                    \end{array}\right]
                </mrow>
                <mrow>  
                    \begin{array}{c}
                    \\
                  \\
                   \xrightarrow{R_3-2R_1}\\
                  \end{array}\amp \left[\begin{array}{ccc|c}  
                   1\amp 1/3\amp 7/3\amp 7/3\\0\amp \fbox{\(4/3\)}\amp -8/3\amp 4/3\\0\amp 1/3\amp -2/3\amp 1/3
                   \end{array}\right] 
                </mrow>
                <mrow>  
                    \begin{array}{c}
                    \\
                     \xrightarrow{\frac{3}{4}R_2}\\
                    \\
                    \end{array}
                    \amp \left[\begin{array}{ccc|c}  
                     1\amp 1/3\amp 7/3\amp 7/3\\0\amp \fbox{\(1\)}\amp -2\amp 1\\0\amp 1/3\amp -2/3\amp 1/3
                     \end{array}\right] 
                </mrow>
                <mrow>  
                    \begin{array}{c}
                    \\
                    \\
                     \xrightarrow{R_3-\frac{1}{3}R_2}\\
                    \end{array}
                    \amp \left[\begin{array}{ccc|c}  
                     1\amp 1/3\amp 7/3\amp 7/3\\0\amp \fbox{\(1\)}\amp -2\amp 1\\0\amp 0\amp 0\amp 0
                     \end{array}\right] 
                </mrow>
                <mrow> \begin{array}{c}
                    \xrightarrow{R_1-\frac{1}{3}R_2}\\
                    \\
                   \\
                   \end{array}
                   \amp \left[\begin{array}{ccc|c}  
                    1\amp 0\amp 3\amp 2\\0\amp 1\amp -2\amp 1\\0\amp 0\amp 0\amp 0
                    \end{array}\right] 
                </mrow>
             </md>
 
 We convert the reduced row-echelon form to a system of equations and find the solution.  The last equation contributes nothing to the system so we omit writing it down.
 
 
<me>
    \begin{array}{ccccccccc}
      x \amp  \amp \amp +\amp 3z\amp = \amp 2 \\
	 \amp  \amp y\amp -\amp 2z\amp =\amp 1
    \end{array}
</me>

    The solution is
    
<me>
    x=2-3t,\quad y=1+2t,\quad z=t.
</me>
       </p>
    </answer>
</example>
<p>
The Gauss-Jordan Algorithm guarantees the existence of the reduced row-echelon form for all matrices.  
When doing computations by hand, however, the algorithm may not always be the optimal method of finding a row-echelon form or the reduced row-echelon form because the procedure often leads to fractions early in the process. 
The following video shows how to arrive at the same reduced row-echelon form for the matrix in <xref ref="ex-gaussjordanalg"/> without doing any fraction arithmetic.  You will see that we still employ row operations, but in a different order.
</p>

<video youtube="76Y41ncuLeQ" play-at="popout"/>

<p>
The video highlights the fact that regardless of what sequence of elementary row operations we take to arrive at the reduced row-echelon form, the end result is the same.  
</p>

</subsection>

<subsection xml:id="Subsection-Rank">
    <title>Rank</title>
    <p>
        This section is an adaptation of Section 1.2 of Keith Nicholson's <url href="https://open.umn.edu/opentextbooks/textbooks/linear-algebra-with-applications"><em>Linear Algebra with Applications</em></url>.
    </p>

<p>
    As stated in <xref ref="th-uniquenessofrref"/>, the reduced row-echelon form of a matrix <m>A</m> is uniquely determined by <m>A</m>. That is, no matter which series of row operations is used to transform <m>A</m> to its reduced row-echelon matrix, the result will always be the same matrix. In contrast, this is not true for row-echelon matrices: different sequences of row operations can transform the same matrix <m>A</m> to different row-echelon matrices. However, it is true that the number <m>r</m> of nonzero rows must be the same in each of these row-echelon matrices, as we will see in Theorem <xref ref="th-dimofrowA"/>. Hence, the number <m>r</m> depends only on <m>A</m> and not on the way in which <m>A</m> is carried to row-echelon form.  
</p>

<example xml:id="ex-rowechofA">
    <p>
        Matrices <xref ref="eq-ref1"/> and <xref ref="eq-ref2"/> of <xref ref="init-gaussianelim1"/> are both row-echelon forms of <m>A</m>.  Both matrices have three nonzero rows.  The same is true for <m>\mbox{rref}(A)</m>.
    </p>
</example>

<definition xml:id="def-rankofamatrix">

    <statement>
        <p>
            The <term>rank</term> of matrix <m>A</m>, denoted by <m>\mbox{rank}(A)</m>, 
            is the number of nonzero rows that remain after we reduce <m>A</m> to row-echelon form by elementary row operations.
        </p>
    </statement>
</definition>



<p> 
The rank a notion connected closely to the existence of solutions and other more nuanced notions emerging later on. We provide an example on how to compute it.
</p> 

<example xml:id="ex-rankofA1">
    <statement>
        <p>
            Compute the rank of 

<me>
    A =  
\begin{bmatrix}
	1 \amp  1 \amp  -1 \amp  4 \\
	2 \amp  1 \amp   3 \amp  0 \\
	0 \amp  1 \amp  -5 \amp  8
\end{bmatrix}
</me>
       </p>
    </statement>
    <answer>
        <p>
            A reduction of <m>A</m> to row-echelon form is

<me>
    
A =  
\begin{bmatrix}
1 \amp  1 \amp  -1 \amp  4 \\
2 \amp  1 \amp   3 \amp  0 \\
0 \amp  1 \amp  -5 \amp  8
\end{bmatrix} \rightsquigarrow\begin{bmatrix}
1 \amp  1 \amp  -1 \amp  4 \\
0 \amp  -1 \amp   5 \amp  -8 \\
0 \amp   0 \amp  0 \amp  0
\end{bmatrix} 

</me>

Because the row-echelon form has two nonzero rows, <m>\mbox{rank}(A) = 2</m>.
       </p>
    </answer>
</example>

<theorem xml:id="th-rankandsolutions">
    <statement>
        <p>
            Suppose a system of <m>m</m> equations in <m>n</m> variables is consistent, and that the rank of the <em>coefficient</em> matrix is <m>r</m>.

<ol>
<li>
      <p> The set of solutions involves exactly <m>n - r</m> parameters, corresponding to <m>n-r</m> free variables. </p>
</li>

<li>
      <p> If <m>r \lt  n</m>, the system has infinitely many solutions. </p>
</li>

<li>
      <p> If <m>r = n</m>, the system has a unique solution. </p>
</li>

</ol>
        </p>
    </statement>
    <proof>
        <p>
    The fact that the rank of the coefficient matrix is <m>r</m> means that there are exactly <m>r</m> leading variables in the coefficient matrix, and hence exactly <m>n - r</m> nonleading variables. The nonleading variables are called free variables.  All free variables are assigned parameters, so the set of solutions involves exactly <m>n - r</m> parameters. Hence if <m>r \lt  n</m>, there is at least one parameter, and so infinitely many solutions. If <m>r = n</m>, there are no parameters and the resulting solution is unique.
        </p>
    </proof>
</theorem>

<p>
<xref ref="th-rankandsolutions"/> shows that, for any system of linear equations, exactly three possibilities exist:

<ol>
<li>
      <p> Unique solution. This occurs when every variable is a leading variable. </p>
</li>

<li>
      <p> Infinitely many solutions. This occurs when the system is consistent and there is at least one nonleading variable, so at least one parameter is involved. </p>
</li>

<li>
      <p> No solution.  This occurs when a row <m>\left[\begin{array}{cccc|c}  0\amp 0\amp \ldots \amp 0\amp 1 \end{array}\right]</m> appears in the row-echelon form. Such a row corresponds to an equation with no solutions. (See <xref ref="ex-nosolutionssys"/>.) </p>
</li>
</ol>
</p>
</subsection>
 

    <exercises xml:id="Exercises-Gaussian-Elimination-and-Rank">
        <exercise xml:id="prob-same-rref">
            <statement>
                <p>
                    Show that applying Gauss-Jordan elimination to the matrix in <xref ref="init-gaussianelim2"/> yields the same reduced row-echelon form as the matrix we obtained in <xref ref="init-gaussianelim1"/>.
                </p>
            </statement>
        </exercise>

        <exercisegroup xml:id="prob-twowaystorref1">
        
            <introduction>
                <p>
                    Follow the indicated steps of the Gauss-Jordan algorithm to transform the matrix to its reduced row-echelon form.
                    <me>
                        \left[\begin{array}{ccc|c}  2\amp 1\amp 1\amp 3\\-1\amp 0\amp 1\amp 2\\1\amp 1\amp -2\amp 0 \end{array}\right]
                    </me>
                </p>
            </introduction>

            <exercise>
                <statement>
                    <p>
                        <m>\frac{1}{2}R_1\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}   1\amp 1/2\amp 1/2\amp 3/2\\-1\amp 0\amp 1\amp 2\\1\amp 1\amp -2\amp 0 \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1+R_2\rightarrow R_2</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1/2\amp 3/2\amp 7/2\\1\amp 1\amp -2\amp 0 \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_3-R_1\rightarrow R_3</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}   1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1/2\amp 3/2\amp 7/2\\0\amp 1/2\amp -5/2\amp -3/2 \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>2R_2\rightarrow R_2</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}   1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1\amp 3\amp 7\\0\amp 1/2\amp -5/2\amp -3/2 \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_3-\frac{1}{2}R_2\rightarrow R_3</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                            1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1\amp 3\amp 7\\0\amp 0\amp -4\amp -5
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>-\frac{1}{4}R_3\rightarrow R_3</m> 
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}    1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1\amp 3\amp 7\\0\amp 0\amp 1\amp 5/4 \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_2-3R_3\rightarrow R_2</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                            1\amp 1/2\amp 1/2\amp 3/2\\0\amp 1\amp 0\amp 13/4\\0\amp 0\amp 1\amp 5/4
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1-\frac{1}{2}R_3\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                1\amp 1/2\amp 0\amp 7/8\\0\amp 1\amp 0\amp 13/4\\0\amp 0\amp 1\amp 5/4
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1-\frac{1}{2}R_2\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                1\amp 0\amp 0\amp -3/4\\0\amp 1\amp 0\amp 13/4\\0\amp 0\amp 1\amp 5/4
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>
        </exercisegroup>
        
        <exercisegroup xml:id="prob-twowaystorref2">
        
            <introduction>
                <p>
                    The following reduction steps do not follow the algorithm but are easier for a human to carry out because they use fewer fractions. Follow the indicated steps to transform the matrix to its reduced row-echelon form.  Steps will unfold automatically as you enter correct answers.
                    <me>
                        \left[\begin{array}{ccc|c}  2\amp 1\amp 1\amp 3\\-1\amp 0\amp 1\amp 2\\1\amp 1\amp -2\amp 0
                    \end{array}\right]
                    </me>
                </p>
            </introduction>
        
            <exercise>
                <statement>
                    <p>
                        <m>R_1+R_2\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                1\amp 1\amp 2\amp 5\\-1\amp 0\amp 1\amp 2\\1\amp 1\amp -2\amp 0
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_2+R_3\rightarrow R_3</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                1\amp 1\amp 2\amp 5\\-1\amp 0\amp 1\amp 2\\0\amp 1\amp -1\amp 2
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1+R_2\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                0\amp 1\amp 3\amp 7\\-1\amp 0\amp 1\amp 2\\0\amp 1\amp -1\amp 2
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1-R_3\rightarrow R_1</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                0\amp 0\amp 4\amp 5\\-1\amp 0\amp 1\amp 2\\0\amp 1\amp -1\amp 2
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>\frac{1}{4}R_1\rightarrow R_1</m> and <m>-R_2\rightarrow R_2</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                0\amp 0\amp 1\amp 5/4\\1\amp 0\amp -1\amp -2\\0\amp 1\amp -1\amp 2
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1+R_2\rightarrow R_2</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                                0\amp 0\amp 1\amp 5/4\\1\amp 0\amp 0\amp -3/4\\0\amp 1\amp -1\amp 2
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        <m>R_1+R_3\rightarrow R_3</m>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                            \left[\begin{array}{ccc|c}  
                            0\amp 0\amp 1\amp 5/4\\1\amp 0\amp 0\amp -3/4\\0\amp 1\amp 0\amp 13/4
                            \end{array}\right]
                        </me>
                    </p>
                </answer>
            </exercise>

            <exercise>
                <statement>
                    <p>
                        Exchange rows.
                    </p>
                </statement>
                <answer>
                    <p>
                        <m>
                            \left[\begin{array}{ccc|c}  
                                1\amp 0\amp 0\amp -3/4\\0\amp 1\amp 0\amp 13/4\\0\amp 0\amp 1\amp 5/4
                            \end{array}\right]
                        </m>
                    </p>
                </answer>
            </exercise>
        </exercisegroup>

        <exercisegroup>
            <introduction>
                <p>
                    Find the rank of each matrix.
                </p>
            </introduction>
            <exercise xml:id="prob-rankofmat1">
                <statement>
                    <p>
                        <me>
                            A=\begin{bmatrix}4\amp 3\amp -1\\-8\amp -6\amp 2\end{bmatrix}
                        </me>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me> \mbox{rank}(A)=1 </me>
                    </p>
                </answer>
            </exercise>

            <exercise xml:id="prob-rankofmat2">
                <statement>
                    <p>
                        <me>
                B=\begin{bmatrix}1\amp 1\\2\amp -2\\3\amp -1\end{bmatrix}
            </me>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                \mbox{rank}(B)=2
            </me>
                    </p>
                </answer>
            </exercise>

            <exercise xml:id="prob-rankofmat3">
                <statement>
                    <p>
                        <me>
                C=\begin{bmatrix}1\amp 0\amp 1\\2\amp 1\amp 3\\0\amp 1\amp -2\end{bmatrix}
            </me>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                \mbox{rank}(C)=3
            </me>
                    </p>
                </answer>
            </exercise>

            <exercise xml:id="prob-rankofmat4">
                <statement>
                    <p>
                        <me>
                D=\begin{bmatrix}1\amp 1\amp 2\\-1\amp -2\amp 1\\1\amp 0\amp 5\end{bmatrix}
            </me>
                    </p>
                </statement>
                <answer>
                    <p>
                        <me>
                \mbox{rank}(D)=2
            </me>
                    </p>
                </answer>
            </exercise>
        </exercisegroup>

        <exercise xml:id="prob-rankofmat5">
            <statement>
                <p>
                    Suppose <m>A</m> is a <m>5\times 7</m> matrix.  Which of the following can be true?
                </p>
            </statement>
        <choices>
            <choice>
                <p> <m>\mbox{rank}(A)=7</m> </p>
            </choice>
            <choice>
                <p> <m>\mbox{rank}(A)=6</m> </p>
            </choice>}
            <choice correct="yes">
                <p> <m>\mbox{rank}(A)=5</m>} </p>
            </choice>
            <choice>
                <p> All of the above </p>
            </choice>
        </choices>
        </exercise>

        <exercise xml:id="prob-4eq5un">
            <statement>
                <p>
                    Suppose a linear system has <m>4</m> equations and <m>5</m> unknowns.  Which of the following is NOT a possibility?
                </p>
            </statement>
        <choices>
            <choice correct="yes">
                <p> The system has a unique solution </p>
            </choice>
            <choice>
                <p> The system has no solutions </p>
            </choice>
            <choice>
                <p> The system has infinitely many solutions </p>
            </choice>
        </choices>
        </exercise>

        <exercise xml:id="prob-leadones">
            <statement>
                <p>
                    Suppose <m>A</m> is a matrix such that <m>\mbox{rref}(A)</m> has <m>5</m> leading <m>1's</m>.  What do we know to be true about <m>A</m>?  Select ALL that apply.
                </p>
            </statement>
        <choices>
            <choice correct="yes">
                <p> <m>\mbox{rank}(A)=5</m>} </p>
            </choice>
            <choice correct="yes">
                <p> <m>A</m> has at least <m>25</m> entries </p>
            </choice>
            <choice correct="yes">
                <p> Any row-echelon form of <m>A</m> will have exactly <m>5</m> nonzero rows </p>
            </choice>
            <choice>
                <p> Some row-echelon forms of <m>A</m> may have more than <m>5</m> nonzero rows </p>
            </choice>
            <choice>
                <p> Some row-echelon forms of <m>A</m> may have less than <m>5</m> nonzero rows </p>
            </choice>
        </choices>
        </exercise>

        <exercise xml:id="prob-rankaugvscoeff">
            <statement>
                <p>
                    In this problem we will discuss how the rank of the <em>coefficient matrix</em> associated with a linear system compares to the rank of the <em>augmented matrix</em> associated with the system.
        <ol marker="a">
        <li>
            <p> Explain why the rank of the augmented matrix has to be greater than or equal to the rank of the coefficient matrix. </p>
        </li>
            <li>
            <p> Prove that for a <em>consistent</em> system the rank of the coefficient matrix will be the same as the rank of the <em>augmented</em> matrix. </p>
        </li>
            <li>
            <p> Give an example of an inconsistent system for which the rank of the augmented matrix is greater than the rank of the coefficient matrix. </p>
        </li>
            <li>
            <p> Can the rank of an augmented matrix be greater than the number of variables? </p>
        </li>
            <li>
            <p> Is the following statement true? </p>
            <p> <q>If the rank of the augmented matrix associated with a linear system is greater than the rank of the coefficient matrix, then the system is inconsistent.</q> </p>
        </li>
        </ol>
                </p>
            </statement>
        </exercise>

    </exercises>


    <references>
        <biblio xml:id="ref-Nicholson">
            <p> W. Keith Nicholson, <em>Linear Algebra with Applications</em>, Lyryx 2018, Open Edition, p 15-17. </p>
        </biblio>
        <biblio xml:id="ref-Yuster">
            <p> Thomas Yuster, The Reduced Row Echelon Form of a Matrix is Unique: a
                Simple Proof, Mathematics Magazine, vol. 57, no. 2 (Mar. 1984), pp. 93-94. 
            </p>
        </biblio>
    </references>

</section>