<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="Section-Gaussian-Elimination-and-Rank" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Gaussian Elimination and Rank</title>

<subsection xml:id="Subsection-Row-Echelon-and-Reduced-Row-Echelon-Forms">
    <title>Row Echelon and Reduced Row Echelon Forms</title>

    <p>
In <url href="https://ximera.osu.edu/oerlinalg/LinearAlgebra/SYS-0020/main">Augmented Matrix Notation and Elementary Row Operations</url>, we learned to write linear systems in <term>augmented matrix</term> form and use elementary row operations to transform an augmented matrix to <term>row-echelon form</term> and the <term>reduced row-echelon form</term> in order to solve linear systems.  
</p>

<p>
Recall that a matrix (or augmented matrix) is in <term>row-echelon form</term> if:
<ul>
<li>
    <p>
    </p>
</li> All entries {\it below} each leading entry are <m>0</m>.
<li>
    <p>
    </p>
</li> Each leading entry is in a column to the right of the leading entries in the rows above it.
<li>
    <p>
    </p>
</li> All rows of zeros, if there are any, are located below non-zero rows.
</ul>

A matrix in row-echelon form is said to be in <term>reduced row-echelon form</term> if it has the following additional properties
<ul>
<li>
    <p>
    </p>
</li> Each leading entry is a <m>1</m>
<li>
    <p>
    </p>
</li> All entries {\it above} each leading <m>1</m> are <m>0</m>
</ul>


Matrices in row-echelon form and reduced row-echelon form are ``convenient" because their corresponding systems of equations are easy to solve.  

In this module we turn to the question of existence and uniqueness of the two echelon forms.  Can every matrix (augmented matrix) be carried to a row-echelon form?  If so, is the row-echelon form unique?  Can every matrix be reduced to a reduced row-echelon form?  If so, is the reduced row-echelon form unique?  The answers we find will have long-lasting implications.


<exploration>
    <p>\label{init:gaussianelim1}
Solve the following system of equations.

<me>
    \begin{array}{ccccccccc}
      x \amp+ \amp2y\amp-\amp3z\amp= \amp1 \\
	 -5x\amp +\amp2y\amp-\amp3z\amp=\amp1\\
      x\amp- \amp2y\amp+\ampz\amp=\amp1
    \end{array}
</me>


We create an augmented matrix corresponding to the system and apply row operations until the matrix is in row-echelon form.  

<me>
    \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\-5\amp2\amp-3\amp1\\1\amp-2\amp1\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp12\amp-18\amp6\\0\amp-4\amp4\amp0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{3}R_2}\\
 \end{array}
</me>

 <men>\label{eq:ref1}
 \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp12\amp-18\amp6\\0\amp0\amp-2\amp2
 \end{array}\right]
</men>

Note that the elementary row operations that lead to (<xref ref="eq-ref1"/>) were not prescribed.  We may employ row-operations in a different manner and obtain a different matrix in row-echelon form.  For example, suppose for some reason we had begun by switching the first and third rows.


<me>
    \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\-5\amp2\amp-3\amp1\\1\amp-2\amp1\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_1\leftrightarrow R_3}\\
\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\-5\amp2\amp-3\amp1\\1\amp2\amp-3\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
\\
\\
 \end{array}
</me>


Next we would reduce this matrix to row-echelon form, perhaps in this way:


<me>
    \left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\-5\amp2\amp-3\amp1\\1\amp2\amp-3\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\0\amp-8\amp2\amp6\\0\amp4\amp-4\amp0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{2}R_2}\\
 \end{array}

</me>

<men>\label{eq:ref2}
 \left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\0\amp-8\amp2\amp6\\0\amp0\amp-3\amp3
 \end{array}\right]
</men>

The augmented matrices in (<xref ref="eq-ref1"/>) and (<xref ref="eq-ref2"/>) are clearly not the same, but both are in row-echelon form.

If we write the systems of equations corresponding to (<xref ref="eq-ref1"/>) and (<xref ref="eq-ref2"/>), we can employ back substitution to solve them.  The matrix in (<xref ref="eq-ref1"/>) corresponds to

<me>
    \begin{array}{ccccccccc}
      x \amp+ \amp2y\amp-\amp3z\amp= \amp1 \\
	 \amp \amp12y\amp-\amp18z\amp=\amp6\\
      \amp\amp\amp\amp-2z\amp=\amp2
    \end{array}
</me>

    
The matrix in (<xref ref="eq-ref2"/>) corresponds to    

<me>
    \begin{array}{ccccccccc}
      x \amp- \amp2y\amp+\ampz\amp= \amp1 \\
	 \amp \amp-8y\amp+\amp2z\amp=\amp6\\
      \amp\amp\amp\amp-3z\amp=\amp3
    \end{array}
</me>

    
Because both systems are equivalent to the original system, it is not surprising that back substitution yields the same solution for both systems. 


<me>
    x=\answer{0},\quad y=\answer{-1},\quad z=\answer{-1}
</me>


%From the last equation we get <m>z=-1</m>.  
%Next, from the second equation we have <m>12y-18(-1)=6</m>, which yields <m>y=-1</m>.
%Finally, the first equation gives us <m>x+2(-1)-3(-1)=1</m>.  Solving for <m>x</m> we get <m>x=0</m>.  
%Therefore, the solution to the system is 
<me>
    x=0, y=-1, z=-1
</me>

%We arrive at a different matrix in row-echelon form, but back-substitution yields the same solution to the system (you should check this):  
<me>
    x=0, y=-1, z=-1
</me>

    </p>
</exploration>

It is clear from Exploration <xref ref="init-gaussianelim1"/> that a row-echelon form corresponding to a matrix is not unique.  But what about the reduced row-echelon form?

<exploration>
    <p>\label{init:gaussianelim2} In this problem we revisit the system

<me>
    \begin{array}{ccccccccc}
      x \amp+ \amp2y\amp-\amp3z\amp= \amp1 \\
	 -5x\amp +\amp2y\amp-\amp3z\amp=\amp1\\
      x\amp- \amp2y\amp+\ampz\amp=\amp1
    \end{array}
</me>

    
Following the steps we took to get (<xref ref="eq-ref1"/>), but taking the process a little further, we get the reduced row-echelon form.

<me>
    \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\-5\amp2\amp-3\amp1\\1\amp-2\amp1\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp12\amp-18\amp6\\0\amp-4\amp4\amp0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{3}R_2}\\
 \end{array}
</me>

 
<me>
    \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp12\amp-18\amp6\\0\amp0\amp-2\amp2
 \end{array}\right]
  \color{blue}
 \begin{array}{c}
 \\
  \xrightarrow{\frac{1}{12}R_2}\\
 \xrightarrow{-\frac{1}{2}R_3}\\
 \end{array}
 \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp1\amp-\frac{3}{2}\amp\frac{1}{2}\\0\amp0\amp1\amp-1
 \end{array}\right]
  \begin{array}{c}
  \xrightarrow{R_1+3R_3}\\
 \xrightarrow{R_2+\frac{3}{2}R_3}\\
\\
 \end{array}
</me>

<men>\label{eq:rref3}  \color{blue}
 \left[\begin{array}{ccc|c}  
 1\amp2\amp0\amp-2\\0\amp1\amp0\amp-1\\0\amp0\amp1\amp-1
 \end{array}\right]
  \begin{array}{c}
  \xrightarrow{R_1-2R_2}\\
 \\
\\
 \end{array}
 \color{black}
  \left[\begin{array}{ccc|c}  
 1\amp0\amp0\amp0\\0\amp1\amp0\amp-1\\0\amp0\amp1\amp-1
 \end{array}\right]</men>
Do you think it is possible to start with (<xref ref="eq-ref2"/>) and obtain the same reduced row-echelon form?  Try to justify your response.  If possible, find the elementary row operations that take (<xref ref="eq-ref2"/>) to the reduced row-echelon form in (<xref ref="eq-rref3"/>).


<me>
    \left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\-5\amp2\amp-3\amp1\\1\amp-2\amp1\amp1
 \end{array}\right]
 \begin{array}{c}
 \\
 \xrightarrow{R_1\leftrightarrow R_3}\\
\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\-5\amp2\amp-3\amp1\\1\amp2\amp-3\amp1
 \end{array}\right]
</me>


<me>
    \begin{array}{c}
 \\
 \xrightarrow{R_2+5R_1}\\
 \xrightarrow{R_3-R_1}\\
 \end{array}
\left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\0\amp-8\amp2\amp6\\0\amp4\amp-4\amp0
 \end{array}\right]
 \begin{array}{c}
 \\
 \\
 \xrightarrow{R_3+\frac{1}{2}R_2}\\
 \end{array}

</me>

<me>
  \left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\0\amp-8\amp2\amp6\\0\amp0\amp-3\amp3
 \end{array}\right]
 \color{red}
 \begin{array}{c}
\rightsquigarrow\text{Elementary}\rightsquigarrow\\
\text{Row Ops.}
\end{array}
 \color{black}
  \left[\begin{array}{ccc|c}  
 1\amp0\amp0\amp0\\0\amp1\amp0\amp-1\\0\amp0\amp1\amp-1
 \end{array}\right]
</me>
You will be asked to fill in the elementary row operations in Practice Problem <xref ref="prob-same_rref"/>.
    </p>
</exploration>

Our observations in Exploration <xref ref="init-gaussianelim2"/> are summarized in the following diagram.

\begin{center}
<image width="100%">
   <shortdescription></shortdescription>
    <latex-image>
      \begin{tikzpicture}
  \node[] at (0, 0)  (o)    {\(\left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\-5\amp2\amp-3\amp1\\1\amp-2\amp1\amp1
 \end{array}\right]\)};
 \node[] at (-3, -2.5)  (left1)    {\(\left[\begin{array}{ccc|c}  
 1\amp2\amp-3\amp1\\0\amp12\amp-18\amp6\\0\amp0\amp-2\amp2
 \end{array}\right]\)};
 \node[] at (3, -2.5)  (right1)    {\(\left[\begin{array}{ccc|c}  
 1\amp-2\amp1\amp1\\0\amp-8\amp2\amp6\\0\amp0\amp-3\amp3
 \end{array}\right]\)};
 \node[gray] at (0, -2.5)  (c1)    {\shortstack{Row-\\Echelon\\Forms}};
 \node[] at (0, -5)  (c2)    {\(\left[\begin{array}{ccc|c}  1\amp0\amp0\amp0\\0\amp1\amp0\amp-1\\0\amp0\amp1\amp-1
 \end{array}\right]\)};
 \node[gray] at (0, -6)  (c3)    {Reduced Row-Echelon Form};
 
 \draw [-\gt,line width=0.5pt,-stealth]  (o.west)to[out=180, in=90](left1.north);
  \draw [-\gt,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north west);
  \draw [-\gt,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north east);
  \draw [-\gt,line width=0.5pt,-stealth]  (o.south)to[out=270, in=90](c1.north);
 \draw [-\gt,line width=0.5pt,-stealth]  (o.east)to[out=0, in=90](right1.north);
 \draw [-\gt,line width=0.5pt,-stealth,blue]  (left1.south)to[out=270, in=180](c2.west);
 \draw [-\gt,line width=0.5pt,-stealth,red]  (right1.south)to[out=270, in=0](c2.east);
     \end{tikzpicture}
    </latex-image>
</image>
 \end{center} 
We observed that a row-echelon form associated with a matrix is not unique.  In contrast, we also saw how different sequences of elementary row operations lead to the same solution set and the same reduced row-echelon form.  It turns out that the reduced row-echelon form of a matrix is unique.  

<theorem>
    <statement>
        <p>\label{th:uniquenessofrref} The reduced row-echelon form of a matrix is unique.
        </p>
    </statement>
</theorem>
A proof of this result can be found in [Yuster]. 

The reduced row-echelon form of a matrix is an instance of a row-echelon form of the matrix.  While a given matrix may have multiple row-echelon forms, all row-echelon forms will share one characteristic: the number of nonzero rows in a row-echelon form of the given matrix will be the same.
We will prove this result in Theorem <xref ref="th-samenumberofnonzerorows"/>.

\section*{Gaussian and Gauss-Jordan Elimination}

<definition>
    <statement>
        <p>[Gaussian Elimination]\label{def:GaussianElimination}
The process of using the elementary row operations on a matrix to transform it into row-echelon form is called <term>Gaussian Elimination</term>.
        </p>
    </statement>
</definition>

As we saw in the previous section, it is possible to follow different sequences of row operations to arrive at various row-echelon forms.  However, it was not clear whether it is {\it always possible} to find a row-echelon form.  The following algorithm takes any matrix (or augmented matrix) and transforms it into row-echelon form:
<algorithm>
    <statement>
        <p>[Gaussian Algorithm] \label{alg:gaussian} 
Let <m>A</m> be an <m>m\times n</m> matrix.

Set <m>i=1</m> initially.
<ul>
<li>
    <p>
    </p>
</li>[] Step 1. If <m>A</m> consists entirely of zeros, stop;  <m>A</m> is already in row-echelon form.

<li>
    <p>
    </p>
</li>[] Step 2. Otherwise, find the first column from the left containing a nonzero entry in row <m>i</m> or below row <m>i</m>.  This column will be called a <term>pivot column</term>.  Go down the pivot column, beginning with row <m>i</m>. Pick the topmost nonzero entry and call it <m>a</m>. If <m>a</m> is not in row <m>i</m>, switch rows so that <m>a</m> moves to row <m>i</m>.  Now <m>a</m> is the <term>leading entry</term> in its row.  We will also refer to <m>a</m> as a <term>pivot</term>.  

<li>
    <p>
    </p>
</li>[] Step 3. By subtracting multiples of the row containing <m>a</m> from rows below it, make each entry below <m>a</m> zero.

<li>
    <p>
    </p>
</li>[] Step 4.  Set <m>i=i+1</m>.  If <m>i\gtm</m> then stop; <m>A</m> is in row-echelon form.

</ul>

Repeat steps 1--4 on the matrix consisting of the remaining rows.
When the process stops, <m>A</m> will be in row echelon form.
        </p>
    </statement>
</algorithm>
Gaussian Algorithm guarantees that every matrix will have a row-echelon form.  

<example>
    <p>\label{ex:non-augmented}

Use the Gaussian Algorithm to find a row-echelon form of <m>A</m> if 
<me>
    A=\begin{bmatrix}2\amp4\\1\amp2\\-1\amp1\\3\amp5\end{bmatrix}
</me>
 
\begin{explanation}
Following Step 2, we choose the first entry, <m>2</m>, as our pivot.  We then perform step 3, using the top row to get zeros in all entries below the <m>2</m>.

<me>
    \begin{bmatrix} \fbox{<m>2</m>}\amp4\\1\amp2\\-1\amp1\\3\amp5\end{bmatrix}
  \begin{array}{c}
  \\
  \xrightarrow{R_2-(1/2)R_1}\\
  \xrightarrow{R_3+(1/2)R_1}\\
 \xrightarrow{R_4-(3/2)R_1}\\
 \end{array}
\begin{bmatrix}2\amp4\\0\amp0\\0\amp3\\0\amp-1\end{bmatrix}

</me>

The first row is now complete, and we repeat the process on the rows below it. We identify <m>3</m> as a pivot entry in the second column and move the row containing <m>3</m> to be directly below the first completed row.  We then use the <m>3</m> to make each entry below the <m>3</m> a zero.  


<me>
    \begin{bmatrix}2\amp4\\0\amp0\\0\amp\fbox{<m>3</m>}\\0\amp-1\end{bmatrix}
\xrightarrow{R_2\leftrightarrow R_3}\\
\begin{bmatrix}2\amp4\\0\amp\fbox{<m>3</m>}\\0\amp0\\0\amp-1\end{bmatrix}
  \begin{array}{c}
 \\
\\
  \\
 \xrightarrow{R_4+\frac{1}{3}R_2}\\
 \end{array}
 \begin{bmatrix}2\amp4\\0\amp3\\0\amp0\\0\amp0\end{bmatrix}

</me>

This time the algorithm terminates since row 3 and row 4 are zero rows. 
\end{explanation}
    </p>
</example>
 


<definition>
    <statement>
        <p>[Gauss-Jordan Elimination]\label{def:GaussJordanElimination}
The process of using the elementary row operations on a matrix to transform it into reduced row-echelon form is called <term>Gauss-Jordan elimination</term>.
        </p>
    </statement>
</definition>

Given a matrix in row-echelon form, it is easy to bring it the reduced row-echelon form.  For example, continuing with Example <xref ref="ex-non-augmented"/>, we can start where we left off and compute <m>\mbox{rref}(A)</m>.  From our earlier computations we have:


<me>
    \begin{bmatrix}2\amp4\\-1\amp1\\3\amp5\\1\amp2\end{bmatrix}\rightsquigarrow\begin{bmatrix}2\amp4\\0\amp3\\0\amp0\\0\amp0\end{bmatrix}
</me>


Now we create leading <m>1's</m> and use them to to wipe out all non-zero entries above them.

<me>
    \begin{bmatrix}2\amp4\\0\amp3\\0\amp0\\0\amp0\end{bmatrix}
  \begin{array}{c}
    \xrightarrow{(1/2)R_1}\\
  \xrightarrow{(1/3)R_2}\\
  \\ 
  \\
 \end{array}
\begin{bmatrix}1\amp2\\0\amp1\\0\amp0\\0\amp0\end{bmatrix}
  \begin{array}{c}
  \xrightarrow{R_1-2R_2}\\
\\
\\
 \\
 \end{array}
\begin{bmatrix}1\amp0\\0\amp1\\0\amp0\\0\amp0\end{bmatrix}=\mbox{rref}(A)
</me>


The following modification to the Gaussian Algorithm produces the reduced row-echelon form of a matrix.  This algorithm guarantees the existence of the reduced row-echelon form.

<algorithm>
    <statement>
        <p>[Gauss-Jordan Algorithm] \label{alg:gauss-jordan} 
Let <m>A</m> be an <m>m\times n</m> matrix.
Follow the steps of the Gaussian Algorithm but modify Step 2 to create leading <m>1's</m> by multiplying the row containing <m>a</m> by <m>\frac{1}{a}</m>.
%Set <m>i=1</m> initially.
%<ul>
%<li>
    <p>
    </p>
</li>[] Step 1. If <m>A</m> consists entirely of zeros, stop.  <m>A</m> is already in row-echelon form.

%<li>
    <p>
    </p>
</li>[] Step 2*. Otherwise, find the first column from the left containing a nonzero entry in row <m>i</m> or below row <m>i</m>.  This column will be called a <term>pivot column</term>.  Scan the pivot column from top to bottom, starting with row <m>i</m>.  Pick the topmost nonzero entry and call it <m>a</m>.  Switch rows, if necessary, to move the row containing <m>a</m> to row <m>i</m>.  Now <m>a</m> is the <term>leading entry</term> in its row.  We will also refer to <m>a</m> as a <term>pivot</term>.  Multiply the row containing <m>a</m> by <m>\frac{1}{a}</m> to create a leading <m>1</m>.  

%<li>
    <p>
    </p>
</li>[] Step 3*. By subtracting multiples of the row containing the leading <m>1</m> from rows {\it above} and below it, make each entry above and below the leading <m>1</m> zero.

%<li>
    <p>
    </p>
</li>[] Step 4.  Set <m>i=i+1</m>.  If <m>i\gtm</m> then stop, and <m>A</m> will be in row-echelon form.

%</ul>

%Repeat steps 1--4 on the matrix consisting of the remaining rows.
%When the process stops, <m>A</m> will be in reduced row echelon form.
When the Gaussian Algorithm terminates, subtract multiples of the rows containing leading <m>1's</m> from the rows above to make all entries above the pivots zero.
        </p>
    </statement>
</algorithm>





<example>
    <p>\label{ex:gaussjordanalg}
Use the Gauss-Jordan Algorithm to solve the system

<me>
    \begin{array}{ccccccccc}
      3x \amp+ \ampy\amp+\amp7z\amp= \amp7 \\
	 5x\amp +\amp3y\amp+\amp9z\amp=\amp13\\
      2x\amp+ \ampy\amp+\amp4z\amp=\amp5
    \end{array}
</me>

\begin{explanation}
<md>\amp\left[\begin{array}{ccc|c}  
 \fbox{<m>3</m>}\amp1\amp7\amp7\\5\amp3\amp9\amp13\\2\amp1\amp4\amp5
 \end{array}\right]\\
 \begin{array}{c}
  \xrightarrow{\frac{1}{3}R_1}\\
\\
\\
 \end{array}
 \amp\left[\begin{array}{ccc|c}  
 \fbox{<m>1</m>}\amp1/3\amp7/3\amp7/3\\5\amp3\amp9\amp13\\2\amp1\amp4\amp5
 \end{array}\right]\\
 \begin{array}{c}
 \\
 \xrightarrow{R_2-5R_1}\\
\\
\end{array}
\amp\left[\begin{array}{ccc|c}  
 \fbox{<m>1</m>}\amp1/3\amp7/3\amp7/3\\0\amp4/3\amp-8/3\amp4/3\\2\amp1\amp4\amp5
 \end{array}\right]\\
 \begin{array}{c}
  \\
\\
 \xrightarrow{R_3-2R_1}\\
\end{array}\amp\left[\begin{array}{ccc|c}  
 1\amp1/3\amp7/3\amp7/3\\0\amp\fbox{<m>4/3</m>}\amp-8/3\amp4/3\\0\amp1/3\amp-2/3\amp1/3
 \end{array}\right]\\
 \begin{array}{c}
\\
 \xrightarrow{\frac{3}{4}R_2}\\
\\
\end{array}
\amp\left[\begin{array}{ccc|c}  
 1\amp1/3\amp7/3\amp7/3\\0\amp\fbox{<m>1</m>}\amp-2\amp1\\0\amp1/3\amp-2/3\amp1/3
 \end{array}\right]\\
 \begin{array}{c}
\\
\\
 \xrightarrow{R_3-\frac{1}{3}R_2}\\
\end{array}
\amp\left[\begin{array}{ccc|c}  
 1\amp1/3\amp7/3\amp7/3\\0\amp\fbox{<m>1</m>}\amp-2\amp1\\0\amp0\amp0\amp0
 \end{array}\right]\\
 \begin{array}{c}
 \xrightarrow{R_1-\frac{1}{3}R_2}\\
 \\
\\
\end{array}
\amp\left[\begin{array}{ccc|c}  
 1\amp0\amp3\amp2\\0\amp1\amp-2\amp1\\0\amp0\amp0\amp0
 \end{array}\right]
 </md>
 
 We convert the reduced row-echelon form to a system of equations and find the solution.  The last equation contributes nothing to the system so we omit writing it down.
 
 
<me>
    \begin{array}{ccccccccc}
      x \amp \amp\amp+\amp3z\amp= \amp2 \\
	 \amp \ampy\amp-\amp2z\amp=\amp1
    \end{array}
</me>

    The solution is
    
<me>
    x=2-3t,\quad y=1+2t,\quad z=t
</me>

\end{explanation}
    </p>
</example>
The Gauss-Jordan Algorithm guarantees the existence of the reduced row-echelon form for all matrices.  
When doing computations by hand, however, the algorithm may not always be the optimal method of finding a row-echelon form or the reduced row-echelon form because the procedure often leads to fractions early in the process. 
The following video shows how to arrive at the same reduced row-echelon form for the matrix in Example <xref ref="ex-gaussjordanalg"/> without doing any fraction arithmetic.  You will see that we still employ row operations, but in a different order.

\youtube{76Y41ncuLeQ}

The video highlights the fact that regardless of what sequence of elementary row operations we take to arrive at the reduced row-echelon form, the end result is the same.  

</subsection>


<subsection xml:id="Subsection-Rank">
    <title>Rank</title>
</subsection>

As stated in Theorem <xref ref="th-uniquenessofrref"/>, the reduced row-echelon form of a matrix <m>A</m> is uniquely determined by <m>A</m>. That is, no matter which series of row operations is used to transform <m>A</m> to its reduced row-echelon matrix, the result will always be the same matrix. In contrast, this is not true for row-echelon matrices: different sequences of row operations can transform the same matrix <m>A</m> to different row-echelon matrices. However, it is true that the number <m>r</m> of nonzero rows must be the same in each of these row-echelon matrices, as we will see in Theorem <xref ref="th-dimofrowA"/>. Hence, the number <m>r</m> depends only on <m>A</m> and not on the way in which <m>A</m> is carried to row-echelon form.  

<example>
    <p>\label{ex:rowechofA}
Matrices (<xref ref="eq-ref1"/>) and (<xref ref="eq-ref2"/>) of Exploration <xref ref="init-gaussianelim1"/> are both row-echelon forms of <m>A</m>.  Both matrices have three nonzero rows.  The same is true for <m>\mbox{rref}(A)</m>.  
    </p>
</example>

<definition>
    <statement>
        <p>\label{def:rankofamatrix}
The <term>rank</term> of matrix <m>A</m>, denoted by <m>\mbox{rank}(A)</m>, is the number of nonzero rows that remain after we reduce <m>A</m> to row-echelon form by elementary row operations.
        </p>
    </statement>
</definition>

<example>
    <p>\label{ex:rankofA1}
Compute the rank of 

<me>
    A =  
\begin{bmatrix}
	1 \amp 1 \amp -1 \amp 4 \\
	2 \amp 1 \amp  3 \amp 0 \\
	0 \amp 1 \amp -5 \amp 8
\end{bmatrix}
</me>


\begin{explanation}
A reduction of <m>A</m> to row-echelon form is

<me>
    
A =  
\begin{bmatrix}
1 \amp 1 \amp -1 \amp 4 \\
2 \amp 1 \amp  3 \amp 0 \\
0 \amp 1 \amp -5 \amp 8
\end{bmatrix} \rightsquigarrow\begin{bmatrix}
1 \amp 1 \amp -1 \amp 4 \\
0 \amp -1 \amp  5 \amp -8 \\
0 \amp  0 \amp 0 \amp 0
\end{bmatrix} 

</me>

Because the row-echelon form has two nonzero rows, <m>\mbox{rank}(A) = 2</m>.
\end{explanation}
    </p>
</example>

<theorem>
    <statement>
        <p>\label{th:rankandsolutions}
Suppose a system of <m>m</m> equations in <m>n</m> variables is consistent, and that the rank of the {\it coefficient} matrix is <m>r</m>.

<ol>
<li>
    <p>
    </p>
</li> The set of solutions involves exactly <m>n - r</m> parameters, corresponding to <m>n-r</m> free variables.

<li>
    <p>
    </p>
</li> If <m>r \lt n</m>, the system has infinitely many solutions.

<li>
    <p>
    </p>
</li> If <m>r = n</m>, the system has a unique solution.

</ol>
        </p>
    </statement>
</theorem>

<proof>
    <p>
The fact that the rank of the coefficient matrix is <m>r</m> means that there are exactly <m>r</m> leading variables in the coefficient matrix, and hence exactly <m>n - r</m> nonleading variables. The nonleading variables are called free variables.  All free variables are assigned parameters, so the set of solutions involves exactly <m>n - r</m> parameters. Hence if <m>r \lt n</m>, there is at least one parameter, and so infinitely many solutions. If <m>r = n</m>, there are no parameters and the resulting solution is unique.
    </p>
</proof>

Theorem <xref ref="th-rankandsolutions"/> shows that, for any system of linear equations, exactly three possibilities exist:

<ol>

<li>
    <p>
    </p>
</li> Unique solution. This occurs when every variable is a leading variable.

<li>
    <p>
    </p>
</li> Infinitely many solutions. This occurs when the system is consistent and there is at least one nonleading variable, so at least one parameter is involved.

<li>
    <p>
    </p>
</li> No solution.  This occurs when a row <m>\left[\begin{array}{cccc|c}  0\amp0\amp\ldots \amp0\amp1
 \end{array}\right]</m> appears in the row-echelon form. Such a row corresponds to an equation with no solutions. (See Example <xref ref="ex-nosolutionssys"/>.)

</ol>


 
 


\section*{Practice Problems}

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:same_rref}
Show that applying Gauss-Jordan elimination to the matrix in Exploration <xref ref="init-gaussianelim2"/> yields the same reduced row-echelon form as the matrix we obtained in Exploration <xref ref="init-gaussianelim1"/>.
    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:twowaystorref1}
Follow the indicated steps of the Gauss-Jordan algorithm to transform the matrix to its reduced row-echelon form.  Steps will unfold automatically as you enter correct answers.


<me>
    \left[\begin{array}{ccc|c}  2\amp1\amp1\amp3\\-1\amp0\amp1\amp2\\1\amp1\amp-2\amp0
  \end{array}\right]
</me>


 \begin{prompt}  <m>\frac{1}{2}R_1\rightarrow R_1</m>.

<me>
     \left[\begin{array}{ccc|c}   \answer{1}\amp\answer{1/2}\amp\answer{1/2}\amp\answer{3/2}\\-1\amp0\amp1\amp2\\1\amp1\amp-2\amp0
  \end{array}\right]
</me>

 \end{prompt} 

 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
 
 \begin{prompt} <m>R_1+R_2\rightarrow R_2</m>.

<me>
     \left[\begin{array}{ccc|c}  1\amp1/2\amp1/2\amp3/2\\\answer{0}\amp\answer{1/2}\amp\answer{3/2}\amp\answer{7/2}\\1\amp1\amp-2\amp0
  \end{array}\right]
</me>

 \end{prompt}
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_3-R_1\rightarrow R_3</m>.

<me>
     \left[\begin{array}{ccc|c}   1\amp1/2\amp1/2\amp3/2\\0\amp1/2\amp3/2\amp7/2\\\answer{0}\amp\answer{1/2}\amp\answer{-5/2}\amp\answer{-3/2}
  \end{array}\right]
</me>

 \end{prompt}
  <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

  \begin{prompt} <m>2R_2\rightarrow R_2</m>.

<me>
     \left[\begin{array}{ccc|c}   1\amp1/2\amp1/2\amp3/2\\\answer{0}\amp\answer{1}\amp\answer{3}\amp\answer{7}\\0\amp1/2\amp-5/2\amp-3/2
 \end{array}\right]
</me>

\end{prompt}
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_3-\frac{1}{2}R_2\rightarrow R_3</m>.

<me>
     \left[\begin{array}{ccc|c}  
1\amp1/2\amp1/2\amp3/2\\0\amp1\amp3\amp7\\\answer{0}\amp\answer{0}\amp\answer{-4}\amp\answer{-5}
  \end{array}\right]
</me>

 \end{prompt}
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>-\frac{1}{4}R_3\rightarrow R_3</m>.

<me>
    \left[\begin{array}{ccc|c}    1\amp1/2\amp1/2\amp3/2\\0\amp1\amp3\amp7\\\answer{0}\amp\answer{0}\amp\answer{1}\amp\answer{5/4}
  \end{array}\right]
</me>

 \end{prompt}
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_2-3R_3\rightarrow R_2</m>.

<me>
     \left[\begin{array}{ccc|c}  
1\amp1/2\amp1/2\amp3/2\\\answer{0}\amp\answer{1}\amp\answer{0}\amp\answer{13/4}\\0\amp0\amp1\amp5/4
  \end{array}\right]
</me>

 \end{prompt}
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_1-\frac{1}{2}R_3\rightarrow R_1</m>.

<me>
     \left[\begin{array}{ccc|c}  
\answer{1}\amp\answer{1/2}\amp\answer{0}\amp\answer{7/8}\\0\amp1\amp0\amp13/4\\0\amp0\amp1\amp5/4
 \end{array}\right]
</me>

  \end{prompt}
  <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_1-\frac{1}{2}R_2\rightarrow R_1</m>.

<me>
     \left[\begin{array}{ccc|c}  
 \answer{1}\amp\answer{0}\amp\answer{0}\amp\answer{-3/4}\\0\amp1\amp0\amp13/4\\0\amp0\amp1\amp5/4
  \end{array}\right]
</me>

  \end{prompt}
     <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
     <answer>
      <p>
       </p>
    </answer>
</exercise>
     <answer>
      <p>
       </p>
    </answer>
</exercise>
 
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:twowaystorref2}
The following reduction steps do not follow the algorithm but are easier for a human to carry out because they use fewer fractions. Follow the indicated steps to transform the matrix to its reduced row-echelon form.  Steps will unfold automatically as you enter correct answers.


<me>
    \left[\begin{array}{ccc|c}  2\amp1\amp1\amp3\\-1\amp0\amp1\amp2\\1\amp1\amp-2\amp0
 \end{array}\right]
</me>


 \begin{prompt} <m>R_1+R_2\rightarrow R_1</m>.

<me>
    \left[\begin{array}{ccc|c}  
 \answer{1}\amp\answer{1}\amp\answer{2}\amp\answer{5}\\-1\amp0\amp1\amp2\\1\amp1\amp-2\amp0
 \end{array}\right]
</me>

\end{prompt} 

 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_2+R_3\rightarrow R_3</m>.

<me>
    \left[\begin{array}{ccc|c}  
1\amp1\amp2\amp5\\-1\amp0\amp1\amp2\\\answer{0}\amp\answer{1}\amp\answer{-1}\amp\answer{2}
 \end{array}\right]
</me>

\end{prompt} 

 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_1+R_2\rightarrow R_1</m>.

<me>
    \left[\begin{array}{ccc|c}  
\answer{0}\amp\answer{1}\amp\answer{3}\amp\answer{7}\\-1\amp0\amp1\amp2\\0\amp1\amp-1\amp2
 \end{array}\right]
</me>

 \end{prompt}

 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_1-R_3\rightarrow R_1</m>.

<me>
    \left[\begin{array}{ccc|c}  
\answer{0}\amp\answer{0}\amp\answer{4}\amp\answer{5}\\-1\amp0\amp1\amp2\\0\amp1\amp-1\amp2
 \end{array}\right]
</me>

 \end{prompt}

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

\begin{prompt} <m>\frac{1}{4}R_1\rightarrow R_1</m> and <m>-R_2\rightarrow R_2</m>.

<me>
    \left[\begin{array}{ccc|c}  
\answer{0}\amp\answer{0}\amp\answer{1}\amp\answer{5/4}\\\answer{1}\amp\answer{0}\amp\answer{-1}\amp\answer{-2}\\0\amp1\amp-1\amp2
 \end{array}\right]
</me>

\end{prompt}

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

\begin{prompt} <m>R_1+R_2\rightarrow R_2</m>.

<me>
    \left[\begin{array}{ccc|c}  
0\amp0\amp1\amp5/4\\\answer{1}\amp\answer{0}\amp\answer{0}\amp\answer{-3/4}\\0\amp1\amp-1\amp2
 \end{array}\right]
</me>

 \end{prompt}
 
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} <m>R_1+R_3\rightarrow R_3</m>.

<me>
    \left[\begin{array}{ccc|c}  
0\amp0\amp1\amp5/4\\1\amp0\amp0\amp-3/4\\\answer{0}\amp\answer{1}\amp\answer{0}\amp\answer{13/4}
 \end{array}\right]
</me>

 \end{prompt}
 
 <exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

 \begin{prompt} Exchange rows.
<m>\left[\begin{array}{ccc|c}  
 1\amp0\amp0\amp\answer{-3/4}\\0\amp1\amp0\amp\answer{13/4}\\0\amp0\amp1\amp\answer{5/4}
 \end{array}\right]</m>
 \end{prompt}

     <answer>
      <p>
       </p>
    </answer>
</exercise>
      <answer>
      <p>
       </p>
    </answer>
</exercise>
       <answer>
      <p>
       </p>
    </answer>
</exercise>
        <answer>
      <p>
       </p>
    </answer>
</exercise>
         <answer>
      <p>
       </p>
    </answer>
</exercise>
          <answer>
      <p>
       </p>
    </answer>
</exercise>
           <answer>
      <p>
       </p>
    </answer>
</exercise>
            <answer>
      <p>
       </p>
    </answer>
</exercise>


<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>

Find the rank of each matrix.
<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankofmat1}

<me>
    A=\begin{bmatrix}4\amp3\amp-1\\-8\amp-6\amp2\end{bmatrix}
</me>

Answer:


<me>
    \mbox{rank}(A)=\answer{1}
</me>

    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankofmat2}

<me>
    B=\begin{bmatrix}1\amp1\\2\amp-2\\3\amp-1\end{bmatrix}
</me>

Answer:


<me>
    \mbox{rank}(B)=\answer{2}
</me>

    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankofmat3}

<me>
    C=\begin{bmatrix}1\amp0\amp1\\2\amp1\amp3\\0\amp1\amp-2\end{bmatrix}
</me>

Answer:


<me>
    \mbox{rank}(C)=\answer{3}
</me>

    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankofmat4}

<me>
    D=\begin{bmatrix}1\amp1\amp2\\-1\amp-2\amp1\\1\amp0\amp5\end{bmatrix}
</me>

Answer:


<me>
    \mbox{rank}(D)=\answer{2}
</me>

    <answer>
      <p>
       </p>
    </answer>
</exercise>
    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankofmat5}
Suppose <m>A</m> is a <m>5\times 7</m> matrix.  Which of the following can be true?
\begin{multipleChoice}
 \choice{<m>\mbox{rank}(A)=7</m>}
 \choice{<m>\mbox{rank}(A)=6</m>}
 \choice[correct]{<m>\mbox{rank}(A)=5</m>}
 \choice{All of the above}
 \end{multipleChoice}
    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:4eq5un}
Suppose a linear system has <m>4</m> equations and <m>5</m> unknowns.  Which of the following is NOT a possibility?
\begin{multipleChoice}
  \choice[correct]{The system has a unique solution}
 \choice{The system has no solutions}
 \choice{The system has infinitely many solutions}
 \end{multipleChoice}
    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:leadones}
Suppose <m>A</m> is a matrix such that <m>\mbox{rref}(A)</m> has <m>5</m> leading <m>1's</m>.  What do we know to be true about <m>A</m>?  Select ALL that apply.
\begin{selectAll}
 \choice[correct]{<m>\mbox{rank}(A)=5</m>}
 \choice[correct]{<m>A</m> has at least <m>25</m> entries}
 \choice[correct]{Any row-echelon form of <m>A</m> will have exactly <m>5</m> nonzero rows}
 \choice{Some row-echelon forms of <m>A</m> may have more than <m>5</m> nonzero rows}
 \choice{Some row-echelon forms of <m>A</m> may have less than <m>5</m> nonzero rows}
 \end{selectAll}
    <answer>
      <p>
       </p>
    </answer>
</exercise>

<exercise xml:id="prob-">
    <statement>
       <p>
       </p>
  </statement>
\label{prob:rankaugvscoeff}
In this problem we will discuss how the rank of the {\it coefficient matrix} associated with a linear system compares to the rank of the {\it augmented matrix} associated with the system.  
<ol>
<li>
    <p>
    </p>
</li> Explain why the rank of the augmented matrix has to be greater than or equal to the rank of the coefficient matrix.
    <li>
    <p>
    </p>
</li> Prove that for a {\it consistent} system the rank of the coefficient matrix will be the same as the rank of the {\it augmented} matrix.
    <li>
    <p>
    </p>
</li> Give an example of an inconsistent system for which the rank of the augmented matrix is greater than the rank of the coefficient matrix.
    <li>
    <p>
    </p>
</li> Can the rank of an augmented matrix be greater than the number of variables?
    <li>
    <p>
    </p>
</li> Is the following statement true?
    
    ``If the rank of the augmented matrix associated with a linear system is greater than the rank of the coefficient matrix, then the system is inconsistent."
</ol>
    <answer>
      <p>
       </p>
    </answer>
</exercise>

\section*{Text Source}
The section on Rank is an adaptation of Section 1.2 of Keith Nicholson's \href{https://open.umn.edu/opentextbooks/textbooks/linear-algebra-with-applications}{\it Linear Algebra with Applications}.

W. Keith Nicholson, {\it Linear Algebra with Applications}, Lyryx 2018, Open Edition, p 15-17.

\section*{Bibliography}

[Yuster] Thomas Yuster, The Reduced Row Echelon Form of a Matrix is Unique: a
Simple Proof, Mathematics Magazine, vol. 57, no. 2 (Mar. 1984), pp. 93-94.
\end{document} 
</section>